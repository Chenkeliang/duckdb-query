#!/usr/bin/env python3
"""
创建测试数据文件
生成0711.xlsx和0702.xlsx用于测试
"""

import pandas as pd
import os

def create_test_data():
    """创建测试数据文件"""
    
    # 确保temp_files目录存在
    temp_dir = "temp_files"
    if not os.path.exists(temp_dir):
        os.makedirs(temp_dir)
    
    # 创建0711.xlsx数据
    data_0711 = {
        "序号": [26, 120, 250, 339],
        "提交答卷时间": ["2025/7/11 10:30", "2025/7/11 11:45", "2025/7/11 14:20", "2025/7/11 16:15"],
        "所用时间": ["56秒", "92秒", "123秒", "84秒"],
        "来源": ["自定义链接", "自定义链接", "自定义链接", "自定义链接"],
        "来源详情": ["", "", "", ""],
        "来自IP": ["", "", "", ""],
        "1、手机号（*请务必核对，填写的手机号是您下单AI学习圈的手机号）": ["am2zm...", "VXuqH...", "AY4Z67...", "EyHsRF..."],
        "uid": ["36.112....", "60.255....", "223.74....", "39.149.1..."],
        "2、请输入您的收货地址：—收货人姓名：": ["185008...", "151816...", "137602...", "151885..."],
        "2、所在地区：": ["107225...", "183925...", "222922...", "12703975"],
        "2、详细地址:": ["刘丽平", "蒲宗黄", "庭己", "付淋"],
        "2、收货人电话：": ["北京-北...", "四川-宜...", "广东-深...", "河南-许..."]
    }
    
    # 创建0702.xlsx数据
    data_0702 = {
        "序号": [26, 120, 250, 339, 401],
        "提交答卷时间": ["2025/7/2 09:15", "2025/7/2 10:30", "2025/7/2 13:45", "2025/7/2 15:20", "2025/7/2 17:30"],
        "所用时间": ["45秒", "78秒", "156秒", "92秒", "67秒"],
        "来源": ["自定义链接", "自定义链接", "自定义链接", "自定义链接", "自定义链接"],
        "来源详情": ["", "", "", "", ""],
        "来自IP": ["", "", "", "", ""],
        "1、手机号（*请务必核对，填写的手机号是您下单AI学习圈的手机号）": ["am2zm...", "VXuqH...", "AY4Z67...", "EyHsRF...", "BK9X2..."],
        "uid": ["36.112....", "60.255....", "223.74....", "39.149.1....", "45.678...."],
        "2、请输入您的收货地址：—收货人姓名：": ["185008...", "151816...", "137602...", "151885...", "198765..."],
        "2、所在地区：": ["107225...", "183925...", "222922...", "12703975", "334455"],
        "2、详细地址:": ["刘丽平", "蒲宗黄", "庭己", "付淋", "王小明"],
        "2、收货人电话：": ["北京-北...", "四川-宜...", "广东-深...", "河南-许...", "上海-浦..."]
    }
    
    # 创建DataFrame
    df_0711 = pd.DataFrame(data_0711)
    df_0702 = pd.DataFrame(data_0702)
    
    # 保存为Excel文件
    df_0711.to_excel(os.path.join(temp_dir, "0711.xlsx"), index=False)
    df_0702.to_excel(os.path.join(temp_dir, "0702.xlsx"), index=False)
    
    print("✅ 测试数据文件创建成功！")
    print(f"   - {temp_dir}/0711.xlsx ({len(df_0711)} 行)")
    print(f"   - {temp_dir}/0702.xlsx ({len(df_0702)} 行)")
    print(f"   - 共同字段: uid (用于JOIN操作)")
    
    # 显示数据预览
    print("\n📊 0711.xlsx 数据预览:")
    print(df_0711.head(2).to_string(index=False))
    
    print("\n📊 0702.xlsx 数据预览:")
    print(df_0702.head(2).to_string(index=False))
    
    return True

if __name__ == "__main__":
    create_test_data()
