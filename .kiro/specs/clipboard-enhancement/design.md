# å‰ªè´´æ¿æ•°æ®å¤„ç†å¢å¼º - è®¾è®¡æ–‡æ¡£

## 1. æ¦‚è¿°

### 1.1 è®¾è®¡ç›®æ ‡

å¢å¼º DataPasteCard ç»„ä»¶ï¼Œæä¾›ï¼š
1. **æ™ºèƒ½æ ¼å¼æ£€æµ‹**: è‡ªåŠ¨è¯†åˆ«å¤šç§æ•°æ®æ ¼å¼
2. **è¡Œåˆ—é‡ç»„**: æ”¯æŒå°†å•åˆ—æ•°æ®é‡ç»„ä¸ºå¤šåˆ—è¡¨æ ¼
3. **æ•°æ®æ¸…ç†å·¥å…·**: ä¸€é”®æ¸…ç†å¼•å·ã€ç©ºæ ¼ã€ç©ºå€¼ã€æ ¼å¼åŒ–æ•°å­—
4. **æ’¤é”€åŠŸèƒ½**: æ”¯æŒæ’¤é”€æ¸…ç†æ“ä½œ

### 1.2 è®¾è®¡åŸåˆ™

- **æ™ºèƒ½é»˜è®¤**: è‡ªåŠ¨é€‰æ‹©æœ€ä½³è§£ææ ¼å¼ï¼Œ90% åœºæ™¯æ— éœ€ç”¨æˆ·å¹²é¢„
- **æ¸è¿›å¼å¤æ‚åº¦**: ç®€å•æ•°æ®ä¸€é”®å®Œæˆï¼Œå¤æ‚æ•°æ®å¯è°ƒæ•´
- **éç ´åæ€§**: æ‰€æœ‰æ“ä½œå¯æ’¤é”€ï¼ŒåŸå§‹æ•°æ®ä¸ä¸¢å¤±
- **å³æ—¶åé¦ˆ**: æ“ä½œç»“æœå®æ—¶é¢„è§ˆ

## 2. æ¶æ„è®¾è®¡

### 2.1 æ•°æ®æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŸå§‹æ–‡æœ¬   â”‚ â”€â”€â–¶ â”‚  æ™ºèƒ½è§£æ   â”‚ â”€â”€â–¶ â”‚  æ•°æ®æ¸…ç†   â”‚ â”€â”€â–¶ â”‚  ä¿å­˜æ•°æ®åº“  â”‚
â”‚  (è¾“å…¥)     â”‚     â”‚  (å¤šç­–ç•¥)   â”‚     â”‚  (å¯é€‰)     â”‚     â”‚  (è¾“å‡º)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚                   â”‚
                           â–¼                   â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  æ ¼å¼åˆ‡æ¢   â”‚     â”‚  æ’¤é”€å†å²   â”‚
                    â”‚  è¡Œåˆ—é‡ç»„   â”‚     â”‚             â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 çŠ¶æ€ç®¡ç†

```typescript
interface ClipboardState {
  // åŸå§‹è¾“å…¥
  rawText: string;
  
  // è§£æé…ç½®
  parseConfig: {
    format: 'auto' | 'csv' | 'json' | 'keyvalue' | 'fixedwidth';
    delimiter: string;
    hasHeader: boolean;
  };
  
  // è§£æç»“æœ
  parseResults: ParseResult[];  // å¤šç§è§£ææ–¹æ¡ˆ
  selectedResultIndex: number;  // å½“å‰é€‰ä¸­çš„æ–¹æ¡ˆ
  
  // è¡¨æ ¼æ•°æ®ï¼ˆå½“å‰å·¥ä½œæ•°æ®ï¼‰
  tableData: {
    rows: string[][];
    columnNames: string[];
    columnTypes: string[];
  };
  
  // é‡ç»„é…ç½®
  reshapeConfig: {
    enabled: boolean;
    rows: number;
    cols: number;
    direction: 'row' | 'col';
  };
  
  // æ¸…ç†å†å²ï¼ˆç”¨äºæ’¤é”€ï¼‰
  cleanupHistory: string[][][];
  
  // æ¸…ç†ç»Ÿè®¡
  cleanupStats: {
    quotes: number;
    spaces: number;
    nulls: number;
    numbers: number;
  };
  
  // UI çŠ¶æ€
  loading: boolean;
  error: string | null;
  success: string | null;
}
```

## 3. æ ¸å¿ƒåŠŸèƒ½è®¾è®¡

### 3.1 æ™ºèƒ½æ ¼å¼æ£€æµ‹

#### 3.1.1 æ”¯æŒçš„æ ¼å¼

| æ ¼å¼ | æ£€æµ‹è§„åˆ™ | ç½®ä¿¡åº¦è®¡ç®— |
|------|---------|-----------|
| CSV (é€—å·) | æ¯è¡Œé€—å·æ•°ä¸€è‡´ | ä¸€è‡´æ€§ Ã— 100 |
| TSV (Tab) | æ¯è¡Œ Tab æ•°ä¸€è‡´ | ä¸€è‡´æ€§ Ã— 100 |
| ç®¡é“ç¬¦åˆ†éš” | æ¯è¡Œ \| æ•°ä¸€è‡´ | ä¸€è‡´æ€§ Ã— 95 |
| åˆ†å·åˆ†éš” | æ¯è¡Œåˆ†å·æ•°ä¸€è‡´ | ä¸€è‡´æ€§ Ã— 95 |
| å¤šç©ºæ ¼åˆ†éš” | è¿ç»­ 2+ ç©ºæ ¼ | ä¸€è‡´æ€§ Ã— 80 |
| JSON | æœ‰æ•ˆ JSON è¯­æ³• | 95 |
| é”®å€¼å¯¹ | åŒ¹é… key: value æ¨¡å¼ | åŒ¹é…ç‡ Ã— 90 |
| å›ºå®šå®½åº¦ | åˆ—å¯¹é½ä½ç½®ä¸€è‡´ | å¯¹é½åº¦ Ã— 70 |

#### 3.1.2 è§£æç­–ç•¥æ¥å£

```typescript
interface ParseResult {
  strategy: string;        // ç­–ç•¥åç§°
  confidence: number;      // ç½®ä¿¡åº¦ 0-100
  rows: string[][];        // è§£æåçš„æ•°æ®
  columns: number;         // åˆ—æ•°
  preview: string[][];     // é¢„è§ˆæ•°æ®ï¼ˆå‰5è¡Œï¼‰
  hasHeader: boolean;      // æ˜¯å¦æœ‰è¡¨å¤´
}

interface ParseStrategy {
  name: string;
  parse: (text: string) => ParseResult;
}
```

#### 3.1.3 è§£ææµç¨‹

```typescript
const smartParse = (text: string): ParseResult[] => {
  const strategies: ParseStrategy[] = [
    delimiterStrategy(','),
    delimiterStrategy('\t'),
    delimiterStrategy('|'),
    delimiterStrategy(';'),
    multiSpaceStrategy(),
    jsonStrategy(),
    keyValueStrategy(),
    fixedWidthStrategy(),
  ];
  
  return strategies
    .map(s => s.parse(text))
    .filter(r => r.confidence > 0)
    .sort((a, b) => b.confidence - a.confidence);
};
```

### 3.2 è¡Œåˆ—é‡ç»„

#### 3.2.1 åŠŸèƒ½è¯´æ˜

å°† N ä¸ªå•å…ƒæ ¼é‡ç»„ä¸º R è¡Œ Ã— C åˆ—çš„è¡¨æ ¼ã€‚

#### 3.2.2 æ¥å£è®¾è®¡

```typescript
interface ReshapeConfig {
  rows: number;
  cols: number;
  direction: 'row' | 'col';  // å¡«å……æ–¹å‘
}

const reshapeData = (
  data: string[],
  config: ReshapeConfig
): string[][] => {
  const { rows, cols, direction } = config;
  const result: string[][] = [];
  
  for (let i = 0; i < rows; i++) {
    const row: string[] = [];
    for (let j = 0; j < cols; j++) {
      const idx = direction === 'row' 
        ? i * cols + j 
        : j * rows + i;
      row.push(data[idx] ?? '');
    }
    result.push(row);
  }
  
  return result;
};
```

#### 3.2.3 éªŒè¯é€»è¾‘

```typescript
const validateReshape = (totalCells: number, rows: number, cols: number) => {
  const targetCells = rows * cols;
  
  if (targetCells < totalCells) {
    return {
      valid: true,
      warning: `å°†ä¸¢å¤± ${totalCells - targetCells} ä¸ªå•å…ƒæ ¼`,
    };
  } else if (targetCells > totalCells) {
    return {
      valid: true,
      info: `å°†å¡«å…… ${targetCells - totalCells} ä¸ªç©ºå•å…ƒæ ¼`,
    };
  }
  
  return { valid: true, success: 'å®Œç¾åŒ¹é…' };
};
```

### 3.3 æ•°æ®æ¸…ç†

#### 3.3.1 æ¸…ç†æ“ä½œ

| æ“ä½œ | è¯´æ˜ | å®ç° |
|------|------|------|
| å»é™¤å¼•å· | å»é™¤é¦–å°¾çš„å•/åŒå¼•å· | `cell.replace(/^["'](.*)["']$/, '$1')` |
| å»é™¤ç©ºæ ¼ | trim æ‰€æœ‰å•å…ƒæ ¼ | `cell.trim()` |
| æ¸…ç†ç©ºå€¼ | null/N/A/- è½¬ä¸ºç©º | åŒ¹é…åˆ—è¡¨æ›¿æ¢ |
| æ ¼å¼åŒ–æ•°å­— | å»é™¤åƒåˆ†ä½å’Œè´§å¸ç¬¦å· | `cell.replace(/[$Â¥â‚¬,ï¼Œ]/g, '')` |

#### 3.3.2 æ¸…ç†å‡½æ•°

```typescript
type CleanupAction = 'quotes' | 'spaces' | 'nulls' | 'numbers' | 'all';

const cleanupFunctions: Record<CleanupAction, (rows: string[][]) => CleanupResult> = {
  quotes: (rows) => {
    let count = 0;
    const cleaned = rows.map(row => row.map(cell => {
      if ((cell.startsWith('"') && cell.endsWith('"')) ||
          (cell.startsWith("'") && cell.endsWith("'"))) {
        count++;
        return cell.slice(1, -1);
      }
      return cell;
    }));
    return { rows: cleaned, affected: count };
  },
  
  spaces: (rows) => {
    let count = 0;
    const cleaned = rows.map(row => row.map(cell => {
      const trimmed = cell.trim();
      if (trimmed !== cell) count++;
      return trimmed;
    }));
    return { rows: cleaned, affected: count };
  },
  
  nulls: (rows) => {
    const nullValues = ['null', 'NULL', 'N/A', 'n/a', '-', 'undefined', 'NaN', 'nil'];
    let count = 0;
    const cleaned = rows.map(row => row.map(cell => {
      if (nullValues.includes(cell.trim())) {
        count++;
        return '';
      }
      return cell;
    }));
    return { rows: cleaned, affected: count };
  },
  
  numbers: (rows) => {
    let count = 0;
    const cleaned = rows.map(row => row.map(cell => {
      const original = cell;
      const cleaned = cell.replace(/[$Â¥â‚¬Â£,ï¼Œ\s]/g, '');
      if (!isNaN(Number(cleaned)) && cleaned !== original) {
        count++;
        return cleaned;
      }
      return cell;
    }));
    return { rows: cleaned, affected: count };
  },
  
  all: (rows) => {
    let result = { rows, affected: 0 };
    for (const action of ['quotes', 'spaces', 'nulls', 'numbers'] as CleanupAction[]) {
      const r = cleanupFunctions[action](result.rows);
      result = { rows: r.rows, affected: result.affected + r.affected };
    }
    return result;
  },
};
```

### 3.4 æ’¤é”€åŠŸèƒ½

#### 3.4.1 å®ç°æ–¹å¼

ä½¿ç”¨å†å²æ ˆä¿å­˜æ¯æ¬¡æ¸…ç†å‰çš„çŠ¶æ€ï¼š

```typescript
const useCleanupHistory = (initialData: string[][]) => {
  const [history, setHistory] = useState<string[][][]>([]);
  const [currentData, setCurrentData] = useState(initialData);
  
  const pushHistory = () => {
    setHistory(prev => [...prev, currentData]);
  };
  
  const undo = () => {
    if (history.length === 0) return;
    const prev = history[history.length - 1];
    setHistory(h => h.slice(0, -1));
    setCurrentData(prev);
  };
  
  const cleanup = (action: CleanupAction) => {
    pushHistory();
    const result = cleanupFunctions[action](currentData);
    setCurrentData(result.rows);
    return result.affected;
  };
  
  const reset = (newData: string[][]) => {
    setHistory([]);
    setCurrentData(newData);
  };
  
  return {
    data: currentData,
    canUndo: history.length > 0,
    undo,
    cleanup,
    reset,
  };
};
```

## 4. UI è®¾è®¡

### 4.1 æ•´ä½“å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“‹ ç²˜è´´æ•°æ®å¯¼å…¥                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                                                                     â”‚ â”‚
â”‚ â”‚  åœ¨æ­¤ç²˜è´´æ•°æ®...                                                     â”‚ â”‚
â”‚ â”‚                                                                     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                         â”‚
â”‚ [è§£ææ•°æ®]  æ ¼å¼: [è‡ªåŠ¨æ£€æµ‹ â–¼]  åˆ†éš”ç¬¦: [è‡ªåŠ¨ â–¼]  â–¡ é¦–è¡Œä¸ºè¡¨å¤´          â”‚
â”‚                                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚ ğŸ“Š é¢„è§ˆ (Tab åˆ†éš”ï¼Œç½®ä¿¡åº¦ 95%)              [åˆ‡æ¢æ ¼å¼ â–¼]  [è¡Œåˆ—é‡ç»„ â–¼]   â”‚
â”‚                                                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚ â”‚
â”‚ â”‚ â”‚ åˆ—1        â”‚ åˆ—2        â”‚ åˆ—3        â”‚                           â”‚ â”‚
â”‚ â”‚ â”‚ [________] â”‚ [________] â”‚ [________] â”‚  â† å¯ç¼–è¾‘åˆ—å              â”‚ â”‚
â”‚ â”‚ â”‚ VARCHAR â–¼  â”‚ INTEGER â–¼  â”‚ VARCHAR â–¼  â”‚  â† å¯é€‰ç±»å‹                â”‚ â”‚
â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                           â”‚ â”‚
â”‚ â”‚ â”‚ å¼ ä¸‰       â”‚ 25         â”‚ åŒ—äº¬       â”‚                           â”‚ â”‚
â”‚ â”‚ â”‚ æå››       â”‚ 30         â”‚ ä¸Šæµ·       â”‚                           â”‚ â”‚
â”‚ â”‚ â”‚ ç‹äº”       â”‚ 28         â”‚ å¹¿å·       â”‚                           â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                         â”‚
â”‚ ğŸ§¹ æ•°æ®æ¸…ç†: [å»å¼•å·] [å»ç©ºæ ¼] [æ¸…ç©ºå€¼] [æ ¼å¼åŒ–æ•°å­—] [å…¨éƒ¨] â”‚ [â†© æ’¤é”€]  â”‚
â”‚              âœ… å·²æ¸…ç† 5 ä¸ªå•å…ƒæ ¼                                        â”‚
â”‚                                                                         â”‚
â”‚ è¡¨å: [paste_data_1733400000    ]  â–¡ ç»Ÿä¸€ä¸ºæ–‡æœ¬ç±»å‹                     â”‚
â”‚                                                                         â”‚
â”‚ [ä¿å­˜åˆ°æ•°æ®åº“]                                                           â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 æ ¼å¼åˆ‡æ¢ä¸‹æ‹‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åˆ‡æ¢è§£ææ ¼å¼                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â— Tab åˆ†éš” (æ¨èï¼Œç½®ä¿¡åº¦ 95%)        â”‚
â”‚ â—‹ é€—å·åˆ†éš” (ç½®ä¿¡åº¦ 60%)              â”‚
â”‚ â—‹ å¤šç©ºæ ¼åˆ†éš” (ç½®ä¿¡åº¦ 45%)            â”‚
â”‚ â—‹ å›ºå®šå®½åº¦ (ç½®ä¿¡åº¦ 30%)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è‡ªå®šä¹‰åˆ†éš”ç¬¦: [____]                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 è¡Œåˆ—é‡ç»„é¢æ¿

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¡Œåˆ—é‡ç»„                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å½“å‰æ•°æ®: 6 ä¸ªå•å…ƒæ ¼                                         â”‚
â”‚                                                             â”‚
â”‚ å¿«æ·é€‰é¡¹:                                                    â”‚
â”‚ â—‹ 1 è¡Œ Ã— 6 åˆ—                                                â”‚
â”‚ â—‹ 2 è¡Œ Ã— 3 åˆ—                                                â”‚
â”‚ â—‹ 3 è¡Œ Ã— 2 åˆ—                                                â”‚
â”‚ â—‹ 6 è¡Œ Ã— 1 åˆ—                                                â”‚
â”‚                                                             â”‚
â”‚ è‡ªå®šä¹‰:                                                      â”‚
â”‚ â— [2] è¡Œ Ã— [3] åˆ—                                            â”‚
â”‚   âœ… 2Ã—3=6ï¼Œå®Œç¾åŒ¹é…                                         â”‚
â”‚                                                             â”‚
â”‚ å¡«å……æ–¹å‘:                                                    â”‚
â”‚ â— æŒ‰è¡Œå¡«å…… (A B C â†’ ç¬¬1è¡Œï¼ŒD E F â†’ ç¬¬2è¡Œ)                    â”‚
â”‚ â—‹ æŒ‰åˆ—å¡«å…… (A D â†’ ç¬¬1åˆ—ï¼ŒB E â†’ ç¬¬2åˆ—)                        â”‚
â”‚                                                             â”‚
â”‚ é¢„è§ˆ:                                                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚ â”‚ A      â”‚ B      â”‚ C      â”‚                                â”‚
â”‚ â”‚ D      â”‚ E      â”‚ F      â”‚                                â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                              [å–æ¶ˆ]  [åº”ç”¨é‡ç»„]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 5. ç»„ä»¶è®¾è®¡

### 5.1 ç»„ä»¶ç»“æ„

```
DataPasteCard/
â”œâ”€â”€ index.tsx                 # ä¸»ç»„ä»¶
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ TextInput.tsx         # æ–‡æœ¬è¾“å…¥åŒº
â”‚   â”œâ”€â”€ ParseToolbar.tsx      # è§£æå·¥å…·æ 
â”‚   â”œâ”€â”€ PreviewTable.tsx      # é¢„è§ˆè¡¨æ ¼
â”‚   â”œâ”€â”€ FormatSwitcher.tsx    # æ ¼å¼åˆ‡æ¢ä¸‹æ‹‰
â”‚   â”œâ”€â”€ ReshapePanel.tsx      # è¡Œåˆ—é‡ç»„é¢æ¿
â”‚   â”œâ”€â”€ CleanupToolbar.tsx    # æ¸…ç†å·¥å…·æ 
â”‚   â””â”€â”€ SaveForm.tsx          # ä¿å­˜è¡¨å•
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useSmartParse.ts      # æ™ºèƒ½è§£æ hook
â”‚   â”œâ”€â”€ useReshape.ts         # è¡Œåˆ—é‡ç»„ hook
â”‚   â””â”€â”€ useCleanup.ts         # æ•°æ®æ¸…ç† hook
â””â”€â”€ utils/
    â”œâ”€â”€ parseStrategies.ts    # è§£æç­–ç•¥
    â”œâ”€â”€ cleanupFunctions.ts   # æ¸…ç†å‡½æ•°
    â””â”€â”€ reshapeUtils.ts       # é‡ç»„å·¥å…·
```

### 5.2 ä¸»ç»„ä»¶æ¥å£

```typescript
interface DataPasteCardProps {
  onDataSourceSaved?: (datasource: DataSourceInfo) => void;
}

interface DataSourceInfo {
  id: string;
  name: string;
  sourceType: 'duckdb';
  type: 'table';
  columns: string[];
  columnCount: number;
}
```

## 6. API è®¾è®¡

### 6.1 ä¿å­˜æ•°æ® APIï¼ˆç°æœ‰ï¼‰

```typescript
// POST /api/paste-data
interface PasteDataRequest {
  table_name: string;
  column_names: string[];
  column_types: string[];
  data_rows: string[][];
  delimiter?: string;
  has_header?: boolean;
}

interface PasteDataResponse {
  success: boolean;
  table_name?: string;
  row_count?: number;
  error?: string;
}
```

### 6.2 æ— éœ€æ–°å¢ API

æ‰€æœ‰è§£æã€é‡ç»„ã€æ¸…ç†æ“ä½œéƒ½åœ¨å‰ç«¯å®Œæˆï¼Œæ— éœ€åç«¯æ”¯æŒã€‚

## 7. å®ç°è®¡åˆ’

### 7.1 ä»»åŠ¡æ‹†åˆ†

| ä»»åŠ¡ | æè¿° | å·¥æ—¶ | ä¼˜å…ˆçº§ |
|------|------|------|--------|
| T1 | é‡æ„çŠ¶æ€ç®¡ç†ï¼Œæå– hooks | 2h | P0 |
| T2 | å®ç°æ™ºèƒ½è§£æç­–ç•¥ | 3h | P0 |
| T3 | å®ç°æ ¼å¼åˆ‡æ¢ UI | 2h | P0 |
| T4 | å®ç°è¡Œåˆ—é‡ç»„åŠŸèƒ½ | 3h | P1 |
| T5 | å®ç°æ•°æ®æ¸…ç†å·¥å…·æ  | 2h | P1 |
| T6 | å®ç°æ’¤é”€åŠŸèƒ½ | 1h | P2 |
| T7 | å®ç°æ¸…ç†ç»Ÿè®¡æ˜¾ç¤º | 1h | P2 |
| T8 | æµ‹è¯•å’Œä¼˜åŒ– | 2h | P0 |

**æ€»å·¥æ—¶**: ~16 å°æ—¶

### 7.2 é‡Œç¨‹ç¢‘

1. **M1 - åŸºç¡€å¢å¼º** (T1, T2, T3): æ™ºèƒ½è§£æ + æ ¼å¼åˆ‡æ¢
2. **M2 - é«˜çº§åŠŸèƒ½** (T4, T5): è¡Œåˆ—é‡ç»„ + æ•°æ®æ¸…ç†
3. **M3 - å®Œå–„ä½“éªŒ** (T6, T7, T8): æ’¤é”€ + ç»Ÿè®¡ + æµ‹è¯•

## 8. æµ‹è¯•è®¡åˆ’

### 8.1 æµ‹è¯•ç”¨ä¾‹

| åœºæ™¯ | è¾“å…¥ | é¢„æœŸç»“æœ |
|------|------|---------|
| CSV è§£æ | `a,b,c\n1,2,3` | 2è¡Œ3åˆ—ï¼Œé€—å·åˆ†éš” |
| Tab è§£æ | `a\tb\tc\n1\t2\t3` | 2è¡Œ3åˆ—ï¼ŒTabåˆ†éš” |
| JSON è§£æ | `[{"a":1},{"a":2}]` | 2è¡Œ1åˆ—ï¼ŒJSONæ ¼å¼ |
| è¡Œåˆ—é‡ç»„ | 6ä¸ªå•å…ƒæ ¼ï¼Œ2Ã—3 | 2è¡Œ3åˆ— |
| å»é™¤å¼•å· | `"hello"` | `hello` |
| å»é™¤ç©ºæ ¼ | ` hello ` | `hello` |
| æ¸…ç†ç©ºå€¼ | `null` | `` |
| æ ¼å¼åŒ–æ•°å­— | `$1,234.56` | `1234.56` |

### 8.2 è¾¹ç•Œæµ‹è¯•

- ç©ºæ•°æ®
- å•è¡Œæ•°æ®
- å•åˆ—æ•°æ®
- è¶…å¤§æ•°æ®ï¼ˆ10000+ è¡Œï¼‰
- ç‰¹æ®Šå­—ç¬¦
- æ··åˆæ ¼å¼

## 9. é£é™©è¯„ä¼°

| é£é™© | å½±å“ | ç¼“è§£æªæ–½ |
|------|------|---------|
| è§£æé”™è¯¯ | æ•°æ®ä¸¢å¤± | ä¿ç•™åŸå§‹æ–‡æœ¬ï¼Œæ”¯æŒé‡æ–°è§£æ |
| æ€§èƒ½é—®é¢˜ | å¤§æ•°æ®å¡é¡¿ | è™šæ‹Ÿæ»šåŠ¨ï¼Œåˆ†æ‰¹å¤„ç† |
| æ ¼å¼è¯¯åˆ¤ | ç”¨æˆ·å›°æƒ‘ | æ˜¾ç¤ºå¤šç§æ–¹æ¡ˆï¼Œç”¨æˆ·é€‰æ‹© |

## 10. å‚è€ƒ

- ç°æœ‰ç»„ä»¶: `frontend/src/new/DataSource/DataPasteCard.tsx`
- UI ç»„ä»¶åº“: shadcn/ui
- çŠ¶æ€ç®¡ç†: React hooks
