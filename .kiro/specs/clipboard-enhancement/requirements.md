# 剪贴板数据处理增强 - 需求文档

## 简介

为剪贴板数据导入功能添加一键数据清理按钮，提升用户体验，减少手动编辑工作。

## 术语表

- **DataPasteCard**: 剪贴板数据导入组件
- **数据清理**: 自动处理数据中的格式问题（引号、空格、特殊字符等）
- **一键操作**: 用户点击按钮即可完成批量处理

## 需求

### 需求 1: 一键去除引号

**用户故事**: 作为用户，我希望能一键去除所有单元格中的引号，这样可以快速清理从 Excel 或 CSV 复制的数据。

#### 验收标准

1. WHEN 用户粘贴包含引号的数据 THEN 系统应在预览区域显示"去除引号"按钮
2. WHEN 用户点击"去除引号"按钮 THEN 系统应去除所有单元格中的前后引号（单引号和双引号）
3. WHEN 引号被去除后 THEN 系统应更新预览表格显示处理后的数据
4. WHEN 引号被去除后 THEN 系统应重新推断列类型
5. WHEN 数据中没有引号 THEN 按钮应显示为禁用状态或不显示

### 需求 2: 一键去除空格

**用户故事**: 作为用户，我希望能一键去除所有单元格的前后空格，这样可以确保数据整洁。

#### 验收标准

1. WHEN 用户粘贴包含空格的数据 THEN 系统应在预览区域显示"去除空格"按钮
2. WHEN 用户点击"去除空格"按钮 THEN 系统应去除所有单元格的前后空格（trim）
3. WHEN 空格被去除后 THEN 系统应更新预览表格
4. WHEN 空格被去除后 THEN 系统应重新推断列类型
5. WHEN 数据中没有多余空格 THEN 按钮应显示为禁用状态

### 需求 3: 一键替换空值

**用户故事**: 作为用户，我希望能一键将所有空值、"null"、"N/A" 等替换为真正的空值，这样可以确保数据质量。

#### 验收标准

1. WHEN 用户粘贴包含空值标记的数据 THEN 系统应在预览区域显示"清理空值"按钮
2. WHEN 用户点击"清理空值"按钮 THEN 系统应将 "null", "NULL", "N/A", "n/a", "-", "" 等替换为空字符串
3. WHEN 空值被清理后 THEN 系统应更新预览表格
4. WHEN 空值被清理后 THEN 系统应重新推断列类型
5. WHEN 数据中没有空值标记 THEN 按钮应显示为禁用状态

### 需求 4: 一键格式化数字

**用户故事**: 作为用户，我希望能一键去除数字中的千分位分隔符和货币符号，这样可以正确识别为数字类型。

#### 验收标准

1. WHEN 用户粘贴包含格式化数字的数据 THEN 系统应在预览区域显示"格式化数字"按钮
2. WHEN 用户点击"格式化数字"按钮 THEN 系统应去除数字中的逗号、美元符号、人民币符号等
3. WHEN 数字被格式化后 THEN 系统应更新预览表格
4. WHEN 数字被格式化后 THEN 系统应重新推断列类型（应识别为 INTEGER 或 DOUBLE）
5. WHEN 数据中没有格式化数字 THEN 按钮应显示为禁用状态

### 需求 5: 一键全部清理

**用户故事**: 作为用户，我希望能一键执行所有清理操作，这样可以快速处理复杂的数据。

#### 验收标准

1. WHEN 用户粘贴数据后 THEN 系统应在预览区域显示"全部清理"按钮
2. WHEN 用户点击"全部清理"按钮 THEN 系统应依次执行：去除引号 → 去除空格 → 清理空值 → 格式化数字
3. WHEN 全部清理完成后 THEN 系统应更新预览表格
4. WHEN 全部清理完成后 THEN 系统应重新推断列类型
5. WHEN 全部清理完成后 THEN 系统应显示成功提示（如"已清理 X 个单元格"）

### 需求 6: 撤销功能

**用户故事**: 作为用户，我希望能撤销清理操作，这样可以在清理效果不理想时恢复原始数据。

#### 验收标准

1. WHEN 用户执行任何清理操作 THEN 系统应保存操作前的数据状态
2. WHEN 用户点击"撤销"按钮 THEN 系统应恢复到上一个状态
3. WHEN 没有可撤销的操作 THEN "撤销"按钮应显示为禁用状态
4. WHEN 用户重新粘贴数据 THEN 系统应清空撤销历史
5. WHEN 用户保存数据后 THEN 系统应清空撤销历史

### 需求 7: 清理统计

**用户故事**: 作为用户，我希望看到清理操作的统计信息，这样可以了解数据处理的效果。

#### 验收标准

1. WHEN 用户执行清理操作 THEN 系统应显示受影响的单元格数量
2. WHEN 清理操作完成 THEN 系统应显示清理前后的对比（如"去除了 50 个引号"）
3. WHEN 清理操作没有改变数据 THEN 系统应提示"数据已经很干净，无需清理"
4. WHEN 多个清理操作执行 THEN 系统应显示累计统计
5. WHEN 用户重新粘贴数据 THEN 系统应重置统计信息

### 需求 8: 性能和用户体验

**用户故事**: 作为用户，我希望清理操作快速响应，这样可以流畅地处理大量数据。

#### 验收标准

1. WHEN 数据量小于 1000 行 THEN 清理操作应在 100ms 内完成
2. WHEN 数据量在 1000-10000 行 THEN 清理操作应在 1 秒内完成
3. WHEN 清理操作执行中 THEN 系统应显示加载指示器
4. WHEN 清理操作完成 THEN 系统应显示成功提示（Toast）
5. WHEN 清理操作失败 THEN 系统应显示错误提示并保持原始数据不变

### 需求 9: 行列重组

**用户故事**: 作为用户，当我粘贴的数据是单列多行时，我希望能快速重组为多列表格，避免手动编辑。

#### 验收标准

1. WHEN 用户粘贴单列多行数据 THEN 系统应显示"行列重组"选项
2. WHEN 用户点击"行列重组" THEN 系统应显示所有可行的行列组合（如 6 个单元格 → 1×6, 2×3, 3×2, 6×1）
3. WHEN 用户选择行列组合 THEN 系统应提供"按行填充"和"按列填充"两种方式
4. WHEN 用户输入自定义行列数 THEN 系统应验证并提示是否匹配（如 2×3=6 ✓）
5. WHEN 目标单元格数大于原数据 THEN 系统应提示"将填充 X 个空单元格"
6. WHEN 目标单元格数小于原数据 THEN 系统应提示"将丢失 X 个单元格"
7. WHEN 用户确认重组 THEN 系统应更新预览表格并重新推断列类型

### 需求 10: 智能格式检测

**用户故事**: 作为用户，我希望系统能自动识别多种数据格式，减少手动配置。

#### 验收标准

1. WHEN 用户粘贴数据 THEN 系统应自动检测最可能的格式（CSV、Tab、JSON、键值对等）
2. WHEN 检测到多种可能格式 THEN 系统应按置信度排序并推荐最佳方案
3. WHEN 用户点击"切换格式" THEN 系统应显示所有检测到的格式及其置信度
4. WHEN 用户选择其他格式 THEN 系统应立即更新预览
5. WHEN 所有自动检测都不合适 THEN 用户应能输入自定义分隔符
