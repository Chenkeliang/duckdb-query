# 组件选择原则

## 🎯 核心原则：优先使用成熟的开源组件

### 基本规则
- **禁止重复造轮子**：在实现任何功能前，必须先调研是否有成熟的开源组件
- **优先使用最优秀的组件**：选择社区认可度高、维护活跃的组件库
- **评估迁移成本**：在选择组件时，必须评估后期迁移成本
- **及时建议升级**：发现更好的替代方案时，主动提出建议

## 📋 组件选择决策流程

### 1. 需求分析阶段
当遇到新功能需求时，必须按以下顺序思考：

```
1. 是否有成熟的开源组件可以直接使用？
   ├─ 是 → 评估迁移成本 → 选择最优方案
   └─ 否 → 是否可以组合现有组件实现？
       ├─ 是 → 使用组合方案
       └─ 否 → 评估自行实现的必要性
```

### 2. 组件评估标准
选择组件时必须考虑：

- **社区活跃度**：GitHub Stars、最近更新时间、Issue 响应速度
- **文档质量**：是否有完整的文档和示例
- **TypeScript 支持**：是否有完整的类型定义
- **包大小**：是否会显著增加打包体积
- **依赖关系**：是否引入过多的依赖
- **迁移成本**：后期切换到更好方案的成本

### 3. 迁移成本评估矩阵

| 迁移成本 | 时间范围 | 决策 |
|---------|---------|------|
| 极高 | > 2 天 | ✅ 必须当前就选择最优方案 |
| 高 | 1-2 天 | ✅ 强烈建议当前选择最优方案 |
| 中 | 2-8 小时 | 🟡 可以当前做，也可以后期迁移 |
| 低 | < 2 小时 | 🟢 可以后期按需迁移 |
| 极低 | < 30 分钟 | 🟢 随时可以切换 |

## 🚫 严格禁止的行为

### 禁止自行实现已有成熟方案的功能
- ❌ 自己写表单验证（应使用 react-hook-form + zod）
- ❌ 自己写虚拟滚动（应使用 @tanstack/react-virtual）
- ❌ 自己写拖拽排序（应使用 @dnd-kit/core）
- ❌ 自己写日期格式化（应使用 date-fns）
- ❌ 自己写 Toast 组件（应使用 sonner）
- ❌ 自己写可调整大小的面板（应使用 react-resizable-panels）

### 禁止选择过时或维护不活跃的组件
- ❌ 使用 > 1 年未更新的组件
- ❌ 使用 Issue 堆积严重的组件
- ❌ 使用文档不完整的组件

## ✅ 推荐的组件生态

### UI 组件库
- **shadcn/ui** - 基于 Radix UI 的组件集合（推荐）
- **Radix UI** - 无样式的可访问组件原语
- **Headless UI** - Tailwind 官方无样式组件

### 表单处理
- **react-hook-form** - 高性能表单库（推荐）
- **zod** - TypeScript 优先的模式验证

### 数据获取与状态管理
- **@tanstack/react-query** - 服务端状态管理（推荐）
- **zustand** - 轻量级状态管理
- **jotai** - 原子化状态管理

### 数据展示
- **@tanstack/react-table** - 强大的表格库（推荐）
- **@tanstack/react-virtual** - 虚拟滚动
- **recharts** - 声明式图表库

### 布局与交互
- **react-resizable-panels** - 可调整大小的面板（推荐）
- **@dnd-kit** - 拖拽功能
- **framer-motion** - 动画库

### 工具库
- **date-fns** - 日期处理（推荐）
- **clsx** / **tailwind-merge** - 类名合并
- **sonner** - Toast 通知（推荐）
- **cmdk** - 命令面板

## 🔄 持续改进机制

### 定期技术评审
每个季度应该：
1. 审查当前使用的所有第三方组件
2. 检查是否有更好的替代方案
3. 评估升级或迁移的必要性
4. 更新技术选型文档

### 发现更好方案时的处理流程
1. **立即记录**：在 `.kiro/specs/architecture-principles/` 下创建评估文档
2. **评估迁移成本**：使用迁移成本评估矩阵
3. **制定迁移计划**：如果值得迁移，创建迁移 spec
4. **通知团队**：更新技术选型文档

## 📝 实施检查清单

在实现任何新功能前，必须回答以下问题：

- [ ] 我是否调研了现有的开源解决方案？
- [ ] 我是否评估了至少 3 个候选组件？
- [ ] 我是否考虑了后期迁移成本？
- [ ] 我是否选择了社区最推荐的方案？
- [ ] 我是否记录了选择理由？

## 🎯 目标

通过遵循这些原则，我们要实现：
- **减少维护成本**：使用成熟组件减少 bug 和维护工作
- **提高开发效率**：避免重复造轮子，专注业务逻辑
- **保持技术先进性**：及时采用社区最佳实践
- **降低迁移风险**：提前评估迁移成本，避免技术债务

---

**记住**：时间应该花在解决业务问题上，而不是重新实现已有的轮子。
