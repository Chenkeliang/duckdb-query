# Demo 页面使用说明

## 快速开始

1. 在浏览器中打开 `index.html`
2. 双击左侧数据源面板中的表名
3. 切换不同的 Tab 查看效果

## 功能说明

### 双击选表

在左侧数据源面板中双击任意表名：

- **可视化查询 Tab**：替换当前选中的表
- **SQL 查询 Tab**：选中表（可扩展为插入表名到编辑器）
- **关联查询 Tab**：添加表到关联查询（支持多表）
- **集合操作 Tab**：添加表到集合操作（支持多表）
- **透视表 Tab**：替换当前选中的表

### 关联查询

1. 切换到"关联查询" Tab
2. 双击左侧的表名（如 `sales_data`）
3. 再双击另一个表名（如 `customer_info`）
4. 系统会自动生成表卡片和 JOIN 连接器
5. 点击卡片上的 ❌ 按钮可以移除表

**特性：**
- 第一个添加的表会标记为"主表"
- 自动显示表的字段列表
- 显示 JOIN 类型选择器
- 显示 JOIN 条件配置

### 集合操作

1. 切换到"集合操作" Tab
2. 双击左侧的表名添加到集合操作
3. 可以添加多个表
4. 系统会自动生成表卡片和 UNION 连接器
5. 点击卡片上的 ❌ 按钮可以移除表

**特性：**
- 支持多表集合操作
- 显示字段列表
- 显示 BY NAME 选项
- 显示生成的 SQL 预览

### 可视化查询

1. 切换到"可视化查询" Tab
2. 双击左侧的表名切换数据源
3. 点击左侧的模式卡片（字段选择、筛选条件等）
4. 右侧会显示对应的配置界面

**可用模式：**
- 字段选择 (SELECT)
- 筛选条件 (WHERE)
- 分组聚合 (GROUP BY)
- 排序 (ORDER BY)
- 限制结果 (LIMIT)

## 交互提示

### 视觉反馈

- **选中的表**：背景高亮，图标变为橙色
- **主表标记**：在关联查询中，第一个表会显示"主表"标签
- **悬停效果**：鼠标悬停时显示交互提示

### 控制台日志

打开浏览器开发者工具（F12）可以看到详细的操作日志：

```
selectTable called: sales_data, [Event对象]
Added table: sales_data
✓ Selected table: sales_data
```

## 注意事项

### 这是一个演示页面

- ✅ 支持动态添加/删除表卡片
- ✅ 支持多表选择
- ✅ 显示示例配置界面
- ❌ 不连接真实数据库
- ❌ 不执行实际查询
- ❌ 配置修改不会更新 SQL（SQL 是静态示例）

### 按钮功能

以下按钮在 Demo 中**仅用于展示**：

- 执行按钮
- 保存按钮
- 导出按钮
- 格式化按钮
- 复制 SQL 按钮

## 测试建议

### 基本测试

1. 双击不同的表名，观察选中状态
2. 切换到关联查询，添加 2-3 个表
3. 点击 ❌ 按钮删除表
4. 切换到集合操作，添加 2-3 个表
5. 切换回可视化查询，观察表名是否更新

### 高级测试

1. 在关联查询中添加多个表，然后切换到其他 Tab，再切换回来
2. 在不同 Tab 之间快速切换，观察状态是否正确
3. 双击同一个表两次（在多表模式下会取消选择）
4. 添加所有可用的表，观察界面布局

## 常见问题

### Q: 为什么双击表名后没有反应？

**A:** 检查以下几点：
1. 确保在正确的 Tab 页（关联查询或集合操作）
2. 打开控制台查看是否有错误信息
3. 刷新页面重试

### Q: 为什么删除按钮不工作？

**A:** 确保：
1. 点击的是卡片上的 ❌ 按钮
2. 查看控制台是否有错误
3. 刷新页面重试

### Q: 为什么切换 Tab 后卡片消失了？

**A:** 这是正常的。每个 Tab 维护自己的选中状态。切换回来后，如果之前选择了表，会重新生成卡片。

## 技术细节

### 状态管理

```javascript
AppState = {
  currentTab: 'visual',
  selectedTables: {
    visual: ['sales_data'],
    sql: [],
    join: [],
    set: [],
    pivot: ['sales_data']
  }
}
```

### 动态卡片生成

- `createTableCard()` - 生成表卡片
- `createJoinConnector()` - 生成 JOIN 连接器
- `createSetConnector()` - 生成集合操作连接器
- `updateJoinContent()` - 更新关联查询内容
- `updateSetContent()` - 更新集合操作内容

### 事件处理

- `selectTable()` - 处理双击选表
- `removeTableFromSelection()` - 处理删除表
- `updateTreeSelection()` - 更新左侧树的选中状态
- `updateContentArea()` - 更新右侧内容区

## 相关文档

- [TEST_GUIDE.md](./TEST_GUIDE.md) - 详细的测试指南
- [FIX_SUMMARY.md](./FIX_SUMMARY.md) - 修复总结
- [README.md](./README.md) - 项目概述
