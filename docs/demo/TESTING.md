# DuckQuery Demo 测试文档

## 测试环境

- 浏览器：Chrome/Firefox/Safari 最新版本
- 本地服务器：需要通过 HTTP 服务器访问（不能直接打开 HTML 文件）

## 启动方式

```bash
# 在项目根目录运行
python -m http.server 8000

# 然后访问
http://localhost:8000/docs/demo/index.html
```

## 功能迁移完成清单

### ✅ 已完成迁移

#### 1. 基础布局
- ✅ Sidebar 显示正常
- ✅ Header 显示正常
- ✅ 数据源面板显示正常
- ✅ 主内容区显示正常
- ✅ 统一结果面板

#### 2. 数据源面板
- ✅ 数据源树形列表显示
- ✅ 搜索框功能
- ✅ 折叠/展开按钮
- ✅ 横向拖拽调整宽度
- ✅ DuckDB 表列表
- ✅ 外部数据库（MySQL/PostgreSQL）

#### 3. Tab 切换
- ✅ 二级 Tab（查询模式/异步任务）切换
- ✅ 三级 Tab（可视化/SQL/JOIN/SET/PIVOT）切换
- ✅ Tab 内容正确加载
- ✅ Tab 按钮激活状态

#### 4. 可视化查询 Tab
- ✅ 查询模式卡片显示
- ✅ 字段选择功能
- ✅ 查询模式切换（字段选择/筛选/分组/排序/限制）
- ✅ 左侧模式卡片
- ✅ 右侧动态内容区
- ✅ SQL 预览

#### 5. SQL 查询 Tab
- ✅ SQL 编辑器（textarea）
- ✅ 顶部工具栏（模板/格式化/执行）
- ✅ 快捷操作按钮
- ✅ 查询历史列表
- ✅ DuckDB 语法提示

#### 6. 关联查询 Tab
- ✅ 横向数据源卡片布局
- ✅ 空状态提示
- ✅ 顶部工具栏（清空/执行）
- ✅ SQL 预览区域
- ✅ 双击添加表提示

#### 7. 集合操作 Tab
- ✅ 横向数据源卡片布局
- ✅ 集合操作类型选择（UNION/UNION ALL/INTERSECT/EXCEPT）
- ✅ 空状态提示
- ✅ BY NAME 选项
- ✅ SQL 预览区域

#### 8. 透视表 Tab
- ✅ 横向配置卡片布局
- ✅ 行维度卡片
- ✅ 列维度卡片
- ✅ 聚合指标卡片
- ✅ SQL 预览
- ✅ 透视表说明提示

#### 9. 拖拽功能
- ✅ 数据源面板横向拖拽
- ✅ 统一结果面板纵向拖拽
- ✅ 折叠/展开动画
- ✅ 拖拽分隔线悬停效果
- ✅ 折叠按钮

#### 10. 样式系统
- ✅ CSS 变量定义（浅色/深色模式）
- ✅ 数据源卡片样式
- ✅ IDE 风格表格
- ✅ 代码块样式
- ✅ 查询模式卡片样式
- ✅ 动画效果（fadeIn/slideIn）
- ✅ 工具类（颜色/间距/布局）

### 🔧 功能测试清单

#### 基础交互
- [ ] 点击 Sidebar 导航按钮
- [ ] 切换二级 Tab（查询模式 ↔ 异步任务）
- [ ] 切换三级 Tab（可视化 ↔ SQL ↔ JOIN ↔ SET ↔ PIVOT）
- [ ] 数据源面板折叠/展开
- [ ] 横向拖拽调整数据源面板宽度

#### 数据源面板
- [ ] 双击表名选择
- [ ] 展开/折叠外部数据库
- [ ] 展开/折叠 MySQL 表
- [ ] 展开/折叠 PostgreSQL 表
- [ ] 搜索框输入

#### 可视化查询
- [ ] 点击查询模式卡片切换
- [ ] 字段选择复选框
- [ ] 执行按钮
- [ ] 保存按钮

#### SQL 查询
- [ ] SQL 编辑器输入
- [ ] 模板按钮
- [ ] 格式化按钮
- [ ] 执行按钮
- [ ] 点击查询历史

#### 关联查询
- [ ] 空状态显示
- [ ] 清空按钮
- [ ] 执行按钮

#### 集合操作
- [ ] 切换操作类型（UNION/UNION ALL/INTERSECT/EXCEPT）
- [ ] BY NAME 复选框
- [ ] 清空按钮
- [ ] 执行按钮

#### 透视表
- [ ] 行维度卡片显示
- [ ] 列维度卡片显示
- [ ] 聚合指标卡片显示
- [ ] 移除按钮
- [ ] 添加按钮
- [ ] 清空配置按钮
- [ ] 执行按钮

#### 结果面板
- [ ] 统一结果面板显示
- [ ] 纵向拖拽调整高度
- [ ] 折叠/展开按钮
- [ ] 工具栏按钮（导出/刷新）

## 迁移说明

### 从 testquery.html 迁移的内容

1. **HTML 结构**：
   - 所有 5 个 TAB 页面的完整 HTML 结构
   - 数据源面板的完整结构
   - 统一结果面板结构

2. **JavaScript 功能**：
   - TAB 切换逻辑
   - 数据源面板折叠/展开
   - 横向/纵向拖拽功能
   - 查询模式切换
   - 树形列表展开/折叠

3. **CSS 样式**：
   - 所有必要的样式类
   - 数据源卡片样式
   - 动画效果
   - 颜色变量
   - 工具类

### 布局改进

- ✅ 使用模板系统（templates.js）
- ✅ 分离 HTML/CSS/JS
- ✅ 统一的样式变量
- ✅ 响应式布局
- ✅ 更好的代码组织

## 已知问题

暂无

## 待实现功能（后端交互）

- [ ] 实际的 SQL 查询执行
- [ ] 关联查询的表卡片动态添加
- [ ] 集合操作的表卡片动态添加
- [ ] 透视表的动态配置
- [ ] 异步任务的实时状态更新
- [ ] 数据源的实际加载
