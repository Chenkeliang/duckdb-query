@tailwind base;
@tailwind components;

/* IDE table, result toolbar, code block and popover component styles */
@layer components {
  /* Result toolbar */
  .result-toolbar {
    @apply flex items-center gap-2 px-3 h-8 bg-muted border-b border-border text-xs text-muted-foreground;
  }
  .result-toolbar .font-medium {
    @apply text-foreground;
  }

  /* IDE-like table */
  table.ide-table {
    @apply w-full border-collapse text-[13px] font-mono;
  }
  table.ide-table thead th {
    @apply h-9 px-3 text-left border-b border-border text-muted-foreground bg-muted/20;
  }
  table.ide-table tbody td {
    @apply h-8 px-3 border-b border-border-subtle text-foreground bg-surface;
  }
  table.ide-table tbody tr:last-child td {
    @apply border-b-0;
  }
  table.ide-table thead th:last-child,
  table.ide-table tbody td:last-child {
    @apply border-r-0;
  }

  /* Code block */
  .code-block {
    @apply bg-muted border border-border rounded-lg p-4 font-mono text-sm leading-6 overflow-x-auto text-foreground;
  }

  /* Popover (tooltip/popover surface) */
  .dq-popover {
    @apply bg-surface-elevated border border-border rounded-lg shadow-2xl p-3 text-sm text-foreground;
  }
  .dq-popover-header {
    @apply flex items-center justify-between mb-2;
  }
  .dq-popover-actions {
    @apply flex gap-2 mt-2;
  }

  /* Split container (vertical panes) */
  .split-container {
    @apply flex flex-col h-full relative bg-surface;
  }

  /* Resizer (between top and bottom panes) */
  .resizer {
    @apply h-1 bg-border cursor-ns-resize relative transition-colors duration-normal;
  }
  .resizer:hover {
    @apply bg-primary;
  }

  /* Collapse button inside resizer */
  .collapse-btn {
    @apply absolute left-1/2 -translate-x-1/2 -top-3 px-2 py-0.5 rounded-md bg-muted text-muted-foreground text-xs border border-border shadow-xs;
  }
  .collapse-btn:hover {
    @apply bg-surface-hover text-foreground;
  }
}

/* ============================================
   TanStack DataGrid Styles (AG Grid 风格)
   ============================================ */

/* DataGrid 容器 - 浅色主题 */
.dq-data-grid {
  --dg-background: hsl(0 0% 100%);
  --dg-foreground: hsl(240 10% 3.9%);
  --dg-header-background: hsl(240 5.9% 96%);
  --dg-header-foreground: hsl(240 3.8% 46%);
  --dg-row-odd-background: hsl(240 5.9% 98%);
  --dg-row-hover-background: hsl(240 5.9% 96%);
  --dg-row-selected-background: hsl(221.2 83.2% 53.3% / 0.1);
  --dg-border-color: hsl(240 5.9% 90%);
  --dg-cell-padding: 0 12px;
  --dg-row-height: 32px;
  --dg-header-height: 36px;
  --dg-font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  --dg-font-size: 13px;
  --dg-null-color: hsl(240 5% 64%);
  --dg-selection-border: hsl(221.2 83.2% 53.3%);
  --dg-selection-background: hsl(221.2 83.2% 53.3% / 0.08);
}

/* DataGrid 容器 - 深色主题 */
.dark .dq-data-grid {
  --dg-background: hsl(240 10% 3.9%);
  --dg-foreground: hsl(0 0% 92%);
  --dg-header-background: hsl(240 10% 6%);
  --dg-header-foreground: hsl(0 0% 75%);
  --dg-row-odd-background: hsl(240 10% 5%);
  --dg-row-hover-background: hsl(240 3.7% 12%);
  --dg-row-selected-background: hsl(221.2 83.2% 53.3% / 0.15);
  --dg-border-color: hsl(240 5% 21%);
  --dg-null-color: hsl(240 5% 50%);
  --dg-selection-border: hsl(24.6 95% 53.1%);
  --dg-selection-background: hsl(24.6 95% 53.1% / 0.1);
}

/* DataGrid 主容器 */
.dq-data-grid {
  font-family: var(--dg-font-family);
  font-size: var(--dg-font-size);
  background: var(--dg-background);
  color: var(--dg-foreground);
  border: 1px solid var(--dg-border-color);
  border-radius: 0;
}

/* DataGrid 列头容器 */
.dq-data-grid-header {
  background: var(--dg-header-background);
  border-bottom: 1px solid var(--dg-border-color);
}

/* DataGrid 列头单元格 */
.dq-data-grid-header-cell {
  height: var(--dg-header-height);
  padding: var(--dg-cell-padding);
  color: var(--dg-header-foreground);
  font-weight: 400;
  border-right: 1px solid var(--dg-border-color);
  user-select: none;
  display: flex;
  align-items: center;
  gap: 4px;
}

.dq-data-grid-header-cell:last-child {
  border-right: none;
}

.dq-data-grid-header-cell:hover {
  background: var(--dg-row-hover-background);
}

/* DataGrid 列头排序图标 */
.dq-data-grid-sort-icon {
  flex-shrink: 0;
  opacity: 0.5;
}

.dq-data-grid-sort-icon.active {
  opacity: 1;
  color: hsl(var(--primary));
}

/* DataGrid 列头筛选图标 */
.dq-data-grid-filter-icon {
  flex-shrink: 0;
  opacity: 0.5;
}

.dq-data-grid-filter-icon.active {
  opacity: 1;
  color: hsl(var(--primary));
}

/* DataGrid 列宽调整手柄 */
.dq-data-grid-resize-handle {
  position: absolute;
  right: 0;
  top: 0;
  bottom: 0;
  width: 4px;
  cursor: col-resize;
  background: transparent;
}

.dq-data-grid-resize-handle:hover,
.dq-data-grid-resize-handle:active {
  background: hsl(var(--primary) / 0.5);
}

/* DataGrid 行 */
.dq-data-grid-row {
  display: flex;
  border-bottom: 1px solid var(--dg-border-color);
}

.dq-data-grid-row:nth-child(odd) {
  background: var(--dg-row-odd-background);
}

.dq-data-grid-row:hover {
  background: var(--dg-row-hover-background);
}

.dq-data-grid-row.selected {
  background: var(--dg-row-selected-background);
}

/* DataGrid 单元格 */
.dq-data-grid-cell {
  height: var(--dg-row-height);
  padding: var(--dg-cell-padding);
  border-right: 1px solid var(--dg-border-color);
  display: flex;
  align-items: center;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.dq-data-grid-cell:last-child {
  border-right: none;
}

/* DataGrid 单元格选中状态 */
.dq-data-grid-cell.selected {
  background: var(--dg-selection-background);
}

.dq-data-grid-cell.selection-border-top {
  box-shadow: inset 0 2px 0 0 var(--dg-selection-border);
}

.dq-data-grid-cell.selection-border-bottom {
  box-shadow: inset 0 -2px 0 0 var(--dg-selection-border);
}

.dq-data-grid-cell.selection-border-left {
  box-shadow: inset 2px 0 0 0 var(--dg-selection-border);
}

.dq-data-grid-cell.selection-border-right {
  box-shadow: inset -2px 0 0 0 var(--dg-selection-border);
}

/* 组合边框 */
.dq-data-grid-cell.selection-border-top.selection-border-left {
  box-shadow: inset 0 2px 0 0 var(--dg-selection-border), inset 2px 0 0 0 var(--dg-selection-border);
}

.dq-data-grid-cell.selection-border-top.selection-border-right {
  box-shadow: inset 0 2px 0 0 var(--dg-selection-border), inset -2px 0 0 0 var(--dg-selection-border);
}

.dq-data-grid-cell.selection-border-bottom.selection-border-left {
  box-shadow: inset 0 -2px 0 0 var(--dg-selection-border), inset 2px 0 0 0 var(--dg-selection-border);
}

.dq-data-grid-cell.selection-border-bottom.selection-border-right {
  box-shadow: inset 0 -2px 0 0 var(--dg-selection-border), inset -2px 0 0 0 var(--dg-selection-border);
}

/* 焦点单元格 */
.dq-data-grid-cell.focus {
  outline: 2px solid var(--dg-selection-border);
  outline-offset: -2px;
}

/* NULL 值样式 */
.dq-data-grid-cell-null {
  color: var(--dg-null-color);
  font-style: italic;
}

/* 数字单元格右对齐 */
.dq-data-grid-cell-number {
  justify-content: flex-end;
  text-align: right;
}

/* DataGrid 底部统计栏 */
.dq-data-grid-footer {
  min-height: 28px;
  padding: 0 12px;
  background: var(--dg-header-background);
  border-top: 1px solid var(--dg-border-color);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
  font-size: 12px;
  color: var(--dg-header-foreground);
}

@tailwind utilities;

/* Basic global reset needed for full-bleed layout (no white frame) */
html,
body {
  margin: 0;
  padding: 0;
}

/* Global Variables - Standard Tailwind CSS format */
@layer base {
  :root {
    /* Base colors - HSL values only (no hsl() wrapper) */
    --background: 0 0% 100%;
    --foreground: 240 10% 3.9%;

    /* Surface colors */
    --surface: 0 0% 100%;
    --surface-hover: 240 5.9% 96%;
    --surface-active: 240 4.8% 94%;
    --surface-elevated: 0 0% 100%;

    /* Muted */
    --muted: 240 5.9% 90%;
    --muted-foreground: 240 3.8% 40%;

    /* Primary */
    --primary: 221.2 83.2% 53.3%;
    --primary-foreground: 0 0% 100%;

    /* Border */
    --border: 240 5.9% 85%;
    --border-subtle: 240 5.9% 90%;
    --border-strong: 240 3.7% 15.9%;

    /* Input */
    --input: 0 0% 100%;

    /* State colors */
    --success: 142 76% 36%;
    --success-foreground: 0 0% 100%;
    --success-bg: 142 76% 96%;
    --success-border: 142 76% 86%;

    --warning: 38 92% 50%;
    --warning-foreground: 0 0% 100%;
    --warning-bg: 38 92% 96%;
    --warning-border: 38 92% 86%;

    --error: 0 72% 51%;
    --error-foreground: 0 0% 100%;
    --error-bg: 0 72% 96%;
    --error-border: 0 72% 86%;

    --info: 199 89% 48%;
    --info-foreground: 0 0% 100%;
    --info-bg: 199 89% 96%;
    --info-border: 199 89% 86%;

    /* Shadcn aliases */
    --card: 0 0% 100%;
    --card-foreground: 240 10% 3.9%;
    --secondary: 0 0% 100%;
    --secondary-foreground: 240 10% 3.9%;
    --accent: 240 4.8% 94%;
    --accent-foreground: 240 10% 3.9%;
    --ring: 221.2 83.2% 53.3%;

    /* Radius */
    --radius: 0.5rem;

    /* Shadows */
    --shadow-xs: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
    --shadow-2xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    --shadow-inner: inset 0 2px 4px 0 rgba(0, 0, 0, 0.06);

    /* Typography */
    --font-sans: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI",
      "Helvetica Neue", Arial, sans-serif;
    --font-mono: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco,
      Consolas, "Liberation Mono", "Courier New", monospace;
  }
}

/* Scoped preflight removed - using standard Tailwind preflight instead */

@layer base {
  .dark {
    /* Dark mode - HSL values only */
    --background: 240 10% 3.9%;
    --foreground: 0 0% 98%;

    /* Surface colors */
    --surface: 240 10% 3.9%;
    --surface-hover: 240 3.7% 15.9%;
    --surface-active: 240 3.7% 18%;
    --surface-elevated: 240 10% 6%;

    /* Muted */
    --muted: 240 3.7% 15.9%;
    --muted-foreground: 240 5% 75%;

    /* Primary */
    --primary: 24.6 95% 53.1%;
    --primary-foreground: 0 0% 100%;

    /* Border */
    --border: 240 5% 21%;
    --border-subtle: 240 5% 21%;
    --border-strong: 0 0% 100% / 0.16;

    /* Input */
    --input: 240 10% 3.9%;

    /* State colors */
    --success: 142 76% 46%;
    --success-foreground: 0 0% 100%;
    --success-bg: 142 76% 10%;
    --success-border: 142 76% 20%;

    --warning: 38 92% 60%;
    --warning-foreground: 0 0% 100%;
    --warning-bg: 38 92% 10%;
    --warning-border: 38 92% 20%;

    --error: 0 72% 61%;
    --error-foreground: 0 0% 100%;
    --error-bg: 0 72% 10%;
    --error-border: 0 72% 20%;

    --info: 199 89% 58%;
    --info-foreground: 0 0% 100%;
    --info-bg: 199 89% 10%;
    --info-border: 199 89% 20%;

    /* Shadcn aliases */
    --card: 240 10% 3.9%;
    --card-foreground: 0 0% 98%;
    --secondary: 240 10% 3.9%;
    --secondary-foreground: 0 0% 98%;
    --accent: 240 3.7% 18%;
    --accent-foreground: 0 0% 98%;
    --ring: 24.6 95% 53.1%;

    /* Shadows */
    --shadow-xs: 0 1px 2px 0 rgba(0, 0, 0, 0.3);
    --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.4);
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.4);
    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.5);
    --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.5);
    --shadow-2xl: 0 25px 50px -12px rgba(0, 0, 0, 0.7);
    --shadow-inner: inset 0 2px 4px 0 rgba(0, 0, 0, 0.3);
  }
}
